<div class="main">
  <div class="container">
    <div class="overviewAndFilter">
      <div class="overviewHead">
        <h4>Candidate Overview</h4>
      </div>
      <div class="searchAndFilter">
        <div class="search">
          <input
            [(ngModel)]="serachValue"
            (ngModelChange)="search(serachValue)"
            name="search"
            type="text"
            placeholder="Search Candidate ID/Name"
          />
        </div>
        <!-- <div class="filter">
          <button>Filters</button>
        </div> -->
        <div class="addCandidate">
          <button routerLink="/addcandidate">Add Candidate</button>
        </div>
      </div>
    </div>
    <div *ngIf="hideChipsFilter" class="filterSec">
      <div class="jobOpening">
        <label for="jobOpeningSelect">Job Opening</label><br />
        <select
          id="jobOpeningSelect"
          (change)="jobOpenings($event)"
          [(ngModel)]="selectedFilter"
        >
          <option value="">Please Select</option>
          <option
            *ngFor="let jobOpening of candidateSkillSetsArr"
            [value]="jobOpening"
          >
            {{ jobOpening }}
          </option>
        </select>
      </div>
      <div class="noticePeriod">
        <label for="">Notice Period</label><br />
        <select (change)="noticePeriod($event)" [(ngModel)]="noticePeriodFilter">
          <option value="">Please Select</option>
          <option
            *ngFor="let NoticePeriod of NoticePeriodArr"
            value="{{ NoticePeriod }}"
          >
            {{ NoticePeriod }}
          </option>
        </select>
      </div>
      <div class="source">
        <label for="">Source</label><br />
        <select (change)="source($event)" [(ngModel)]="sourceFilter">
          <option value="">Please Select</option>
          <option *ngFor="let source of SourceArr" value="{{ source }}">
            {{ source }}
          </option>
        </select>
      </div>
      <div class="AddedBy">
        <label for="">Added by</label><br />
        <select (change)="addedBy($event)" [(ngModel)]="addedByFilter">
          <option value="">Please Select</option>
          <option
            *ngFor="let interviewedBy of interviewedByArr"
            value="{{ interviewedBy }}"
          >
            {{ interviewedBy }}
          </option>
        </select>
      </div>
      <div class="startAndEndDate">
        <label for="">Start and End Date</label><br />
        <input
          type="text"
          matInput
          ngxDaterangepickerMd
          style="width: 180px"
          [locale]="{ applyLabel: 'ok', format: 'DD-MM-YYYY' }"
          [(ngModel)]="selected"
          name="daterange"
          placeholder="DD-MM-YYYY~DD-MM-YYYY"
          #pickerr
          (change)="date()"
        />
      </div>
    </div>
    <div style="display: flex;gap: 10px;">
      <div *ngIf="filterChips == true" class="filterChips">
        <span class="filter"
          >{{ selectedFilter }}
          <span (click)="closeFilter()" class="filterClose">X</span></span
        >
      </div>
      <div class="filterChips" *ngIf="noticeFilterChips == true">
        <span class="filter"
          >{{ noticePeriodFilter }} <span (click)="closeNoticeFilter()" class="filterClose">X</span></span
        >
      </div>
      <div class="filterChips" *ngIf="sourceFilterChips == true">
        <span class="filter"
          >{{ sourceFilter }} <span (click)="closeSourceFilter()" class="filterClose">X</span></span
        >
      </div>
      <div class="filterChips" *ngIf="addedByFilterChips == true">
        <span class="filter"
          >{{ addedByFilter }} <span (click)="closeaddedByFilter()" class="filterClose">X</span></span
        >
      </div>
    </div>
    <div
      *ngIf="filterMsg == 'Candidate fetched successfully'"
      class="candidateTable"
    >
      <mat-sidenav-container>
        <mat-sidenav #sidenav mode="side" [opened]="showSidenav">
          <app-sidenav [candidate]="selectedCandidate"></app-sidenav>
        </mat-sidenav>
        <ul *ngIf="hideChipsFilter && filterTabs">
          <li
            (click)="candStatus(i)"
            class="optionType"
            [class.selected]="selectedIndex === i"
            *ngFor="
              let candidateStatusCustom of candidateStatusCustom;
              let i = index
            "
          >
            <input type="radio" name="" id="" />
            <ng-container>
              {{ candidateStatusCustom.name }} - {{totalCandidate}}
            </ng-container>
          </li>
        </ul>
        <table>
          <tbody>
            <tr class="mainHead">
              <th>CANDIDATE NAME</th>
              <th>APPLIED ROLE</th>
              <th>REL EXP</th>
              <th>N PERIOD</th>
              <th>ADDED BY</th>
              <th>STATUS</th>
              <th></th>
              <th></th>
            </tr>
            <tr
              class="details"
              *ngFor="
                let candidate of candidateIndo | paginate : config;
                let i = index
              "
            >
              <td
                class="candidateName"
                (click)="candidatesDetails(candidate._id)"
              >
                {{ candidate.firstName }} {{ candidate.lastName }} <br /><span
                  class="canNum"
                  >SBC0987/Others</span
                >
              </td>
              <td>{{ candidate.currentJobTitle }}</td>
              <td>{{ candidate.relevantExperience }}</td>
              <td>{{ candidate.noticePeriod }}</td>
              <td class="addedBy">
                {{ candidate.interviewBy }} <br /><span class="date">{{
                  candidate.modifiedDate | date
                }}</span>
              </td>
              <td *ngIf="candidate.status == 'Rejected'">
                <span class="rejected">Rejected</span>
              </td>
              <td *ngIf="candidate.status == 'Screening'">
                <span class="screening">Screening</span>
              </td>
              <td *ngIf="candidate.status == 'Round 1'">
                <span class="screening">Round 1</span>
              </td>
              <td *ngIf="candidate.status == 'Round 2'">
                <span class="screening">Round 2</span>
              </td>
              <td *ngIf="candidate.status == 'Task Verification'">
                <span class="screening">Task Verification</span>
              </td>
              <td *ngIf="candidate.status == 'Candidates'">
                <span class="screening">Candidates</span>
              </td>
              <td *ngIf="candidate.status == 'HR Round'">
                <span class="screening">HR Round</span>
              </td>
              <td *ngIf="candidate.status == 'Offered'">
                <span class="screening">Offered</span>
              </td>
              <td *ngIf="candidate.status == 'Offer Accepted'">
                <span class="screening">Offer Accepted</span>
              </td>
              <td *ngIf="candidate.status == 'Offer Declined'">
                <span class="screening">Offer Declined</span>
              </td>
              <td *ngIf="candidate.status == 'Joined'">
                <span class="screening">Joined</span>
              </td>
              <td *ngIf="candidate.status == 'DsRound'">
                <span class="DSRound">DS Round & API</span>
              </td>
              <td class="document">
                <div class="resumeDownload">
                  <img
                    (click)="resumeClick(candidate)"
                    src="../../images/resume.png"
                    alt="doc"
                  />
                </div>
              </td>
              <td (click)="getCandDetails(candidate)" class="list">
                <img src="../../images/editStatus.svg" alt="doc" />
              </td>
            </tr>
            <div class="sidenav" [ngClass]="{ 'sidenav-open': sidenavOpen }">
              <div class="sidenav-content">
                <button (click)="closeSidenav()">Close</button>

                <iframe
                  [src]="resumeUrl"
                  style="width: 718px; height: 100%"
                  frameborder="0"
                ></iframe>
              </div>
            </div>
          </tbody>
        </table>
      </mat-sidenav-container>
      <div class="pagination">
        <pagination-controls
          (pageChange)="gty((page = $event))"
        ></pagination-controls>
      </div>
    </div>
    <div *ngIf="filterMsg == 'Search results not found'" class="ifEmpty">
      <div class="emptyImg">
        <img src="../../images/nodata.jpg" alt="nodata" />
      </div>
    </div>
  </div>

  <div *ngIf="openPopup" class="editAdminSection">
    <div class="editAdmin">
      <div class="editAdminHead">
        <h3>User</h3>
        <img
          style="width: 20px"
          src="../../images/close.svg"
          alt="close"
          (click)="closePopup()"
        />
      </div>
      <form (ngSubmit)="updateStatus(candidatesDetails)">
        <div class="adminRole">
          <label for="">Change Status</label>
          <select [(ngModel)]="updateCandidateStatus" name="status" id="">
            <option value="" disabled="">Please Select</option>
            <option value="Candidates">Candidates</option>
            <option value="Screening">Screening</option>
            <option value="Round 1">Round 1</option>
            <option value="Task Verification">Validation</option>
            <option value="Round 2">Round 2</option>
            <option value="HR Round">HR Round</option>
            <option value="Offered">Offered</option>
            <option value="Offer Accepted">Accepted</option>
            <option value="Offer Declined">Declined</option>
            <option value="Joined">Joined</option>
            <option value="Rejected">Rejected</option>
          </select>
        </div>
        <div class="adminName">
          <label for="">Comments</label>
          <input [(ngModel)]="comment" name="adminName" type="text" />
        </div>
        <div class="adminSubmit">
          <button type="submit">Save</button>
        </div>
      </form>
    </div>
  </div>
</div>

<div id="toasterContainer"></div>
